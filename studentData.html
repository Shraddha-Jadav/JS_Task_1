<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Data</title>
    <link rel="stylesheet" href="Assets/Bootstrap/css/bootstrap.min.css" />

    <!-- Custom CSS -->
    <link rel="stylesheet" href="Assets/css/style.css" />

    <!-- Font Awesome Icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" />

    <!-- Bootstrap Icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
</head>

<body>
    <div class="container">
        <h2 class="d-flex justify-content-center fw-bold text-white border-bottom mb-4 p-4">
            Student Data
        </h2>
        <div class="personal-names mx-5 fw-bold fs-normal">
            <!-- Names of all users will be displayed here -->
            <h4 class="fw-bold text-white">List Of Users:</h4>
            <ul id="nameList" class="list-group border-dark">
                <!-- List items will be dynamically added here -->
            </ul>
        </div>
        <hr />
        <div id="detailsContainer" class="mx-5">
            <!-- Personal and educational details of the selected user will be displayed here -->
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            let allUserData = [];

            function displayUserNames() {
                const nameList = document.getElementById('nameList');
                nameList.innerHTML = '';

                allUserData.forEach((userData, index) => {
                    const { firstName, lastName } = userData.personal;
                    const fullName = `${firstName} ${lastName}`;
                    const listItem = document.createElement('li');
                    listItem.textContent = fullName;
                    listItem.classList.add('list-group-item', 'cursor-pointer', 'bg-transparent');
                    listItem.addEventListener('click', () => displayUserDetails(index));
                    nameList.appendChild(listItem);
                });
            }

            function displayUserDetails(index) {
                const userData = allUserData[index];
                const detailsContainer = document.getElementById('detailsContainer');
                detailsContainer.innerHTML = '';

                // display personal detail
                const personalDataDiv = document.createElement('div');
                personalDataDiv.classList.add('personal-details','border-bottom', 'border-dark' , 'mb-3');
                personalDataDiv.innerHTML = `<h5 class="fw-bold mb-2 text-white">Personal Detail</h5>`;  
                for (const key in userData.personal) {
                    const p = document.createElement('p');
                    p.innerHTML = `<span class="key fw-bold fs-normal pe-2">${key}:</span> <span class="value fw-normal fs-normal">${userData.personal[key]}</span>`;
                    personalDataDiv.appendChild(p);
                }
                detailsContainer.appendChild(personalDataDiv);

                // Create table for educational details
                const eduHeading = document.createElement('h5') ;
                eduHeading.innerHTML = "Educational Detail";
                eduHeading.classList.add('text-white','fw-bold','mb-2');  
                detailsContainer.appendChild(eduHeading);

                const tableContainer = document.createElement('div');
                tableContainer.classList.add('table-responsive');
                
                const table = document.createElement('table');
                table.classList.add('table','table-striped');
                const thead = document.createElement('thead');
                const tbody = document.createElement('tbody');

                // Create table header
                const headerRow = document.createElement('tr');
                for (const key in userData.educational[0]) {
                    const th = document.createElement('th');
                    th.classList.add('fs-normal', 'fw-bold' , 'border-bottom');
                    th.textContent = key;
                    headerRow.appendChild(th);
                }
                thead.appendChild(headerRow);
                table.appendChild(thead);

                // Create table body
                userData.educational.forEach(student => {
                    const row = document.createElement('tr');
                    for (const key in student) {
                        const cell = document.createElement('td');
                        cell.textContent = student[key];
                        row.appendChild(cell);
                    }
                    tbody.appendChild(row);
                });

                table.appendChild(tbody);
                tableContainer.appendChild(table);

                // Append table to details container
                detailsContainer.appendChild(tableContainer);
            }

            function loadUserData() {
                const allUserDataJson = localStorage.getItem('allUserData');
                allUserData = JSON.parse(allUserDataJson) || [];
                displayUserNames();
            }

            loadUserData();
        });
    </script>
</body>

</html>
